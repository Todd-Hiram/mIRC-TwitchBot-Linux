[script]
n0=alias sticky {
n1=  var %re = /(.)\1{ [ $+ [ %protectionspam ] $+ ] ,}/
n2=  return $iif($regex($1-,%re), $regml(1), $null)
n3=}
n4=alias caps {
n5=  var %caps = $calc($regex($1-,/[A-Z]/g) / $regex($1-,/[A-Z]/gi) * 100)
n6=  return %caps
n7=}
n8=alias symbols {
n9=  var %symbols = $calc($regex($1-,/[^a-z0-9]/gi) * 100 / $len($1-))
n10=  return %symbols
n11=}
n12=alias timeout {
n13=  var %timeout = %protection. [ $+ [ $1 ] $+ . $+ [ $2 ] $+ ] .timeout No $2 please.
n14=  msg $1 .timeout $3 %timeout
n15=  if (%protection. [ $+ [ $1 ] $+ ] .silent == Off) {
n16=    if (%flood. [ $+ [ $1 ] $+ . $+ [ $2 ] ]) { return } 
n17=    msg $1  $3 $+ , %protection. [ $+ [ $1 ] $+ . $+ [ $2 ] $+ ] .message
n18=    set -u15 %flood. [ $+ [ $1 ] $+ . $+ [ $2 ] ] On
n19=  }
n20=  return
n21=}
n22=
n23=on *:text:!protection*:#:{
n24=  if (($nick == zapdos26 || $right(#,-1) == $nick) && ( $2 == default ) && ( $3 == set )) {
n25=    set %protection. [ $+ [ # ] $+ ] .caps.status on
n26=    set %protection. [ $+ [ # ] $+ ] .emotes.status on
n27=    set %protection. [ $+ [ # ] $+ ] .spam.status on
n28=    set %protection. [ $+ [ # ] $+ ] .links.status on
n29=    set %protection. [ $+ [ # ] $+ ] .repeat.status on
n30=    set %protection. [ $+ [ # ] $+ ] .blacklist.status on
n31=    set %protection. [ $+ [ # ] $+ ] .symbol.status on
n32=    set %protection. [ $+ [ # ] $+ ] .fakedonation.status on
n33=    set %protection. [ $+ [ # ] $+ ] .silent off
n34=    set %protection. [ $+ [ # ] $+ ] .caps.message Easy on the caps please.
n35=    set %protection. [ $+ [ # ] $+ ] .emotes.message Easy on the emotes please.  
n36=    set %protection. [ $+ [ # ] $+ ] .symbol.message Easy on the symbols please. 
n37=    set %protection. [ $+ [ # ] $+ ] .links.message Leave the links to the moderators please.
n38=    set %protection. [ $+ [ # ] $+ ] .repeat.message Please stop repeating.
n39=    set %protection. [ $+ [ # ] $+ ] .spam.message Please don't spam.
n40=    set %protection. [ $+ [ # ] $+ ] .blacklist.message Keep it PG please.
n41=    set %protection. [ $+ [ # ] $+ ] .fakedonation.message Please don't lie to get attention.
n42=    set %protection. [ $+ [ # ] $+ ] .caps.limitamount 8 
n43=    set %protection. [ $+ [ # ] $+ ] .emotes.limitamount 8
n44=    set %protection. [ $+ [ # ] $+ ] .symbol.limitamount 10
n45=    set %protection. [ $+ [ # ] $+ ] .repeat.limitamount 5
n46=    set %protection. [ $+ [ # ] $+ ] .spam.limitamount 16
n47=    set %protection. [ $+ [ # ] $+ ] .caps.limitpercentage 80
n48=    set %protection. [ $+ [ # ] $+ ] .symbol.limitpercentage 90 
n49=    set %protection. [ $+ [ # ] $+ ] .spam.limitpercentage 90
n50=    set %protection. [ $+ [ # ] $+ ] .caps.timeout 1
n51=    set %protection. [ $+ [ # ] $+ ] .emotes.timeout 1
n52=    set %protection. [ $+ [ # ] $+ ] .spam.timeout 1
n53=    set %protection. [ $+ [ # ] $+ ] .links.timeout 1
n54=    set %protection. [ $+ [ # ] $+ ] .repeat.timeout 1
n55=    set %protection. [ $+ [ # ] $+ ] .blacklist.timeout 1
n56=    set %protection. [ $+ [ # ] $+ ] .symbol.timeout 1
n57=    set %protection. [ $+ [ # ] $+ ] .fakedonation.timeout 1
n58=    set %streamer. [ $+ [ # ] $+ ] .bits.message 
n59=    set %streamer. [ $+ [ # ] $+ ] .bits.amount 1
n60=    msg # The bot's default settings has been set for this channel.
n61=    break
n62=  }
n63=  elseif ($msgtags(mod).key == 1 || $right(#,-1) == $nick) {
n64=    if ($2 != caps && $2 != emotes && $2 != symbol && $2 != spam && $2 != repeat && $2 != blacklist && $2 != links && $2 != silent && $2 != fakedonation ) { goto failure }
n65=    elseif ($3 != on && $3 != off && $3 != message && $3 != limitamount && $3 != limitpercentage && $3 != add && $3 != del && $3 != whitelist && $3 != timeout && $3 != regular && $3 != sub) { goto failure }
n66=    elseif (($2 == blacklist || $2 == links || $2 == fakedonation) && ( $3 == limitamount || $3 == limitpercentage)) { goto failure }
n67=    elseif (($2 != links) && ($3 == whitelist )) { goto failure }
n68=    elseif (($2 != emotes && $2 != blacklist && $2 != links) && ($3 == add || $3 == del)) { goto failure }
n69=    elseif (($3 == timeout) && ($4 !isnum || $4 == 0)) { goto failure }
n70=    elseif (($2 == repeat || $2 == emotes || $2 == spam ) && ($3 == limitpercentage)) { goto failure } 
n71=    elseif (($3 == regular) && ($4 != On && $4 != off)) { goto failure }
n72=    elseif (($3 == regular) && ($4 == On || $4 == off) && ( %protection. [ $+ [ # ] $+ ] . [ $+ [ $2 ] $+ ] .regular == $4)) { 
n73=      msg # Regulars are already protected in reference to $2 $+ .
n74=      break
n75=    }
n76=    elseif (($3 == sub) && ($4 != On && $4 != off)) { goto failure }
n77=    elseif (($3 == sub ) && ($4 == On || $4 == off) && ( %protection. [ $+ [ # ] $+ ] . [ $+ [ $2 ] $+ ] .sub == $4)) { 
n78=      msg # Subscribers are already protected in reference to $2 $+ .
n79=      break
n80=    }
n81=    elseif (( $2 != silent) && ($3 == On || $3 == Off )) && ( %protection. [ $+ [ # ] $+ ] . [ $+ [ $2 ] $+ ] .status == $3)) {
n82=      msg # /me $nick $+ , $2 protection is already $3 $+ .
n83=      break
n84=    }
n85=    elseif (($2 == Silent) && ($3 != on && $3 != off )) { goto failure }
n86=    elseif (($2 == Silent) && ($3 == On || $3 == Off )  && ( %protection. [ $+ [ # ] $+ ] .silent == $3 )) {
n87=      msg # /me $nick $+ , Silent mode is already $3 $+ .
n88=      break
n89=    }
n90=    elseif (($2 == Silent) && ($3 == On || $3 == Off )) {
n91=      set %protection. [ $+ [ # ] $+ ] .silent $3 
n92=      msg # /me $nick $+ , Silent mode is now $3 $+ .
n93=      break
n94=    }
n95=    else {
n96=      if ( $3 == On || $3 == Off ) {
n97=        set %protection. [ $+ [ # ] $+ ] . [ $+ [ $2 ] $+ ] .status $3
n98=        msg # $nick $+ , $2 protection has been turned $3 $+ .
n99=        break
n100=      }
n101=      elseif ($3 == add || $3 == del) {
n102=        var %file $2 $+ .ini
n103=        if ($3 == add) {
n104=          if ($ini(%file,#,$4) == $null) {
n105=            writeini %file # $4 1
n106=            if (emotes == $2) { msg # /me $4 will no longer be counted against the maximum emote limit. }
n107=            else { msg # /me $4 has been added to $2 $+ . }
n108=          }
n109=          else {
n110=            msg # /me $4 is already in $2 $+ . 
n111=          }
n112=        }
n113=        elseif ($3 == del) {
n114=          if ($ini(%file,#,$4) != $null) {
n115=            remini %file # $4
n116=            if (emotes == $2) { msg # /me $4 will be counted against the maximum emote limit. }
n117=            else { msg # /me $4 has been removed from $2 $+ . }
n118=          }
n119=          else {
n120=            msg # Sorry, $4 was not found in $2 $+ .
n121=          }
n122=        }
n123=      }
n124=      elseif ($3 == whitelist) && ($4 == add || $4 == del) {
n125=        var %file $3 $+ .ini
n126=        if ($4 == add) {
n127=          if ($ini(%file,#,$5) == $null) {
n128=            writeini %file # $5 1
n129=            msg # /me $5 has been added to $3 $+ .
n130=          }
n131=          else {
n132=            msg # /me $5 is already in $3 $+ .
n133=          }
n134=        }
n135=        elseif ($4 == del) {
n136=          if ($ini(%file,#,$5) != $null) {
n137=            remini %file # $5
n138=            msg # /me $5 has been removed from $3 $+ .
n139=          }
n140=        }
n141=      }
n142=      else {
n143=        set %protection. [ $+ [ # ] $+ ] . [ $+ [ $2 ] $+ ] . [ $+ [ $3 ] ] $4-
n144=        msg # $nick $+ , $3 has been set for $2 $+ . 
n145=        halt
n146=        :failure
n147=        msg # $nick For more info about how to set the protection settings, visit https://goo.gl/o1Otwc.
n148=        break
n149=      }
n150=    }
n151=  }
n152=}
n153=
n154=on *:text:!permit*:#: {
n155=  if ($msgtags(mod).key == 1 || $right(#,-1) == $nick) {
n156=    set -u30 %permit $addtok(%permit,$2,32)
n157=    msg $chan You have 30 seconds to post a link, $2
n158=  }
n159=}
n160=
n161=on *:TEXT:*:#: {
n162=  if ($msgtags(mod).key == 1) { return }
n163=  if ($nick == $right(#,-1)) { return }
n164=  set %pmessage $1-
n165=  if ($msgtags(emotes).key == $null) { goto continue }
n166=  var %emotecount 0
n167=  var %plines $numtok($1-,32)
n168=  var %i = 1 | while $ini(emotes.ini,#,%i) {
n169=    var %list = %list $v1
n170=    inc %i
n171=  }
n172=  var %j = 0
n173=  while (%j < $numtok(%list,32)) {
n174=    inc %j 
n175=    var %words = $gettok(%list,%j,32)
n176=    set %pmessage $remtok($strip(%pmessage),%words,0,32)
n177=  }
n178=  var %plines $numtok(%pmessage,32)
n179=  while (%plines) {
n180=    var %word $gettok(%pmessage,%plines,32)
n181=    if ($hget(allemotes,%word)) {
n182=      set %pmessage $deltok(%pmessage,%plines,32)
n183=      var %emotecount $calc(%emotecount + 1)
n184=    }
n185=    dec %plines
n186=  }
n187=  :continue
n188=  if (%protection. [ $+ [ # ] $+ ] .links.status == On ) {
n189=    if ((Regular. [ $+ [ # ] ] isin $level($nick)) && (%protection. [ $+ [ # ] $+ ] .links.regular == On )) { return }
n190=    if ($msgtags(subscriber).key == 1) && (%protection. [ $+ [ # ] $+ ] .links.sub == On ) { return }
n191=    if ($istok(%permit,$nick,32)) { return }
n192=    var %q = 1 | while $ini(links.ini, # ,%q) {
n193=      var %listl = %listl $v1
n194=      inc %q
n195=    }
n196=    var %g = 0
n197=    while (%g < $numtok(%listl,32)) {
n198=      inc %g
n199=      var %link = $gettok(%listl,%g,32)
n200=      if (%link isin $1-) {
n201=        var %w = 1 | while $ini(whitelist.ini,#,%w) {
n202=          var %listwl = %listwl $v1
n203=          inc %w
n204=        }
n205=        var %wl = 0
n206=        while (%wl < $numtok(%listwl,32)) {
n207=          inc %wl
n208=          var %wli = $gettok(%listwl,%wl,32)
n209=          if (%wli isin $1-) {
n210=            goto continuingprotection
n211=          }
n212=        }
n213=        var %fff = 1 | while $ini(pun.ini,pun,%fff) {
n214=          var %listp = %listp $v1
n215=          inc %fff
n216=        }
n217=        var %ggg = 0
n218=        while (%ggg < $numtok(%listp,32)) {
n219=          inc %ggg
n220=          var %ddd  $gettok(%listp,%ggg,32)
n221=          if (%link $+ %ddd isin $1-) { goto linktimeout }
n222=          elseif (%ddd $+ %link isin $1-) { goto stop } 
n223=        }  
n224=        elseif ($chr(32) $+ %link iswm $1-) { goto linktimeout }
n225=        if (* $+ %link $+ & iswm $1- ) {
n226=          :stop
n227=          goto continuingprotection
n228=        }
n229=        else {
n230=          :linktimeout
n231=          timeout $chan links $nick
n232=        }
n233=        break
n234=      }
n235=    } 
n236=  }
n237=  :continuingprotection
n238=  if (%protection. [ $+ [ # ] $+ ] .repeat.status == On ) {
n239=    if ((Regular. [ $+ [ # ] ] isin $level($nick)) && (%protection. [ $+ [ # ] $+ ] .repeat.regular == On )) { return }
n240=    if ($msgtags(subscriber).key == 1) && (%protection. [ $+ [ # ] $+ ] .repeat.sub == On ) { return }
n241=    if (%repeat.text. [ $+ [ $nick ] $+ . $+ [ $chan ] ] != $1- || %repeat.times. [ $+ [ $nick ] $+ ] . [ $+ [ $chan ] ] == $null ) {
n242=      set -u3600 %repeat.times. [ $+ [ $nick ] $+ ] . [ $+ [ $chan ] ] 1
n243=      set -u3600 %repeat.text. [ $+ [ $nick ] $+ ] . [ $+ [ $chan ] ] $1-
n244=      goto next
n245=    }
n246=    var %repeattext = %repeat.text. [ $+ [ $nick ] $+ ] . [ $+ [ $chan ] ]
n247=    if (%repeattext = $1-) {
n248=      inc %repeat.times. [ $+ [ $nick ] $+ . $+ [ $chan ] ]
n249=      var %repeats = %repeat.times. [ $+ [ $nick ] $+ . $+ [ $chan ] ]
n250=      if (%repeats >= %protection. [ $+ [ # ] $+ ] .repeat.limitamount) {
n251=        timeout $chan repeat $nick
n252=        break
n253=      }
n254=    }
n255=  }
n256=  :next
n257=  if (%protection. [ $+ [ # ] $+ ] .emotes.status == On ) {
n258=    if ((Regular. [ $+ [ # ] ] isin $level($nick)) && (%protection. [ $+ [ # ] $+ ] .emotes.regular == On )) { return }
n259=    if ($msgtags(subscriber).key == 1) && (%protection. [ $+ [ # ] $+ ] .emotes.sub == On ) { return }
n260=    if (%emotecount >= %protection. [ $+ [ # ] $+ ] .emotes.limitamount ) {
n261=      timeout $chan emotes $nick
n262=      break
n263=    }
n264=  }
n265=  if (%protection. [ $+ [ # ] $+ ] .caps.status == On ) {
n266=    if ((Regular. [ $+ [ # ] ] isin $level($nick)) && (%protection. [ $+ [ # ] $+ ] .caps.regular == On )) { return }
n267=    if ($msgtags(subscriber).key == 1) && (%protection. [ $+ [ # ] $+ ] .caps.sub == On ) { return }
n268=    if ( $len($1-) >= %protection. [ $+ [ # ] $+ ] .caps.limitamount ) {
n269=      if ( $caps(%pmessage) >= %protection. [ $+ [ # ] $+ ] .caps.limitpercentage ) {
n270=        timeout $chan caps $nick
n271=        break
n272=      }
n273=    }
n274=  }
n275=  if (%protection. [ $+ [ # ] $+ ] .symbol.status == On ) {
n276=    if ((Regular. [ $+ [ # ] ] isin $level($nick)) && (%protection. [ $+ [ # ] $+ ] .sybmbol.regular == On )) { return }
n277=    if ($msgtags(subscriber).key == 1) && (%protection. [ $+ [ # ] $+ ] .symbol.sub == On ) { return }
n278=    if ( $len($1-) >= %protection. [ $+ [ # ] $+ ] .symbol.limitamount ) {
n279=      if ( $symbols(%pmessage) >= %protection. [ $+ [ # ] $+ ] .symbol.limitpercentage ) {
n280=        timeout $chan symbol $nick
n281=        halt
n282=      }
n283=    }
n284=  } 
n285=
n286=  if (%protection. [ $+ [ # ] $+ ] .spam.status == On ) {
n287=    if ((Regular. [ $+ [ # ] ] isin $level($nick)) && (%protection. [ $+ [ # ] $+ ] .spam.regular == On )) { return }
n288=    if ($msgtags(subscriber).key == 1) && (%protection. [ $+ [ # ] $+ ] .spam.sub == On ) { return }
n289=    var %spam = 1
n290=    while ($gettok($1-, %spam, 32) != $null) {
n291=      var %word = $v1
n292=      var %protectionspam. %protection. [ $+ [ # ] $+ ] .spam.limitamount
n293=      set %protectionspam %protectionspam.
n294=      if ($sticky(%word) != $null) {
n295=        timeout $chan spam $nick
n296=        break
n297=      }
n298=      inc %spam
n299=    }
n300=  }
n301=  if (%protection. [ $+ [ # ] $+ ] .blacklist.status == On ) {
n302=    if ((Regular. [ $+ [ # ] ] isin $level($nick)) && (%protection. [ $+ [ # ] $+ ] .blacklist.regular == On )) { return }
n303=    if ($msgtags(subscriber).key == 1) && (%protection. [ $+ [ # ] $+ ] .blacklist.sub == On ) { return }
n304=    if ($chr(42) $+ $chr(42) $+ $chr(42) == $1-) { goto timeout }
n305=    if ($chr(32) $+ $chr(42) $+ $chr(42) $+ $chr(42) $+ $chr(32) isin $1- ) { goto timeout }
n306=    var %blackcount = 1 | while $ini(blacklist.ini,#,%blacklist) {
n307=      var %blacklistlist = %blacklistlistlist $v1
n308=      inc %blackcount
n309=    }
n310=    var %black = 0
n311=    while (%black < $numtok(%blacklistlist,32)) {
n312=      inc %black
n313=      var %words = $gettok(%blacklistlist,%black,32)
n314=      var %blackamount = $countcs($strip($1-),%words)     
n315=      if (%blackamount >= 1) {
n316=        :timeout
n317=        timeout $chan blacklist $nick     
n318=        break
n319=      }
n320=    }
n321=  }
n322=}
n323=
n324=on *:action:*:#:{
n325=  if ($msgtags(mod).key == 1) { return }
n326=  if (Regular. [ $+ [ # ] ] isin $level($nick)) && (%protection. [ $+ [ # ] $+ ] .fakedonation.regular == On )) { return }
n327=  if ($msgtags(subscriber).key == 1) && (%protection. [ $+ [ # ] $+ ] .fakedonation.sub == On ) { return }
n328=  if (%protection. [ $+ [ # ] $+ ] .fakedonation.status == Off ) { return }
n329=  if ( $ isin $1- || donate isin $1-) {
n330=    timeout $chan fakedonation $nick
n331=  }
n332=}
