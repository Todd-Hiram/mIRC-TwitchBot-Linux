[script]
n0=alias sticky {
n1=  var %re = /(.)\1{ [ $+ [ %protectionspam ] $+ ] ,}/
n2=  return $iif($regex($1-,%re), $regml(1), $null)
n3=}
n4=
n5=on *:text:!protection*:#:{
n6=  if (($right(#,-1) == $nick) && ( $2 == default ) && ( $3 == set )) {
n7=    set %protection. [ $+ [ # ] $+ ] .caps.status on
n8=    set %protection. [ $+ [ # ] $+ ] .emotes.status on
n9=    set %protection. [ $+ [ # ] $+ ] .spam.status on
n10=    set %protection. [ $+ [ # ] $+ ] .links.status on
n11=    set %protection. [ $+ [ # ] $+ ] .repeat.status on
n12=    set %protection. [ $+ [ # ] $+ ] .blacklist.status on
n13=    set %protection. [ $+ [ # ] $+ ] .symbol.status on
n14=    set %protection. [ $+ [ # ] $+ ] .fakedonation.status on
n15=    set %protection. [ $+ [ # ] $+ ] .silent off
n16=    set %protection. [ $+ [ # ] $+ ] .caps.message Easy on the caps please.
n17=    set %protection. [ $+ [ # ] $+ ] .emotes.message Easy on the emotes please.  
n18=    set %protection. [ $+ [ # ] $+ ] .symbol.message Easy on the symbols please. 
n19=    set %protection. [ $+ [ # ] $+ ] .links.message Leave the links to the moderators please.
n20=    set %protection. [ $+ [ # ] $+ ] .repeat.message Please stop repeating.
n21=    set %protection. [ $+ [ # ] $+ ] .spam.message Please don't spam.
n22=    set %protection. [ $+ [ # ] $+ ] .blacklist.message Keep it PG please.
n23=    set %protection. [ $+ [ # ] $+ ] .fakedonation.message Please don't lie to get attention.
n24=    set %protection. [ $+ [ # ] $+ ] .caps.limitamount 8 
n25=    set %protection. [ $+ [ # ] $+ ] .emotes.limitamount 8
n26=    set %protection. [ $+ [ # ] $+ ] .symbol.limitamount 10
n27=    set %protection. [ $+ [ # ] $+ ] .repeat.limitamount 5
n28=    set %protection. [ $+ [ # ] $+ ] .spam.limitamount 16
n29=    set %protection. [ $+ [ # ] $+ ] .caps.limitpercentage 80
n30=    set %protection. [ $+ [ # ] $+ ] .symbol.limitpercentage 90 
n31=    set %protection. [ $+ [ # ] $+ ] .spam.limitpercentage 90
n32=    set %protection. [ $+ [ # ] $+ ] .caps.timeout 1
n33=    set %protection. [ $+ [ # ] $+ ] .emotes.timeout 1
n34=    set %protection. [ $+ [ # ] $+ ] .spam.timeout 1
n35=    set %protection. [ $+ [ # ] $+ ] .links.timeout 1
n36=    set %protection. [ $+ [ # ] $+ ] .repeat.timeout 1
n37=    set %protection. [ $+ [ # ] $+ ] .blacklist.timeout 1
n38=    set %protection. [ $+ [ # ] $+ ] .symbol.timeout 1
n39=    set %protection. [ $+ [ # ] $+ ] .fakedonation.timeout 1
n40=    set %streamer. [ $+ [ # ] $+ ] .bits.message 
n41=    set %streamer. [ $+ [ # ] $+ ] .bits.amount 1
n42=    msg # The bot's default settings has been set for this channel.
n43=    break
n44=  }
n45=  elseif ($msgtags(mod).key == 1 || $right(#,-1) == $nick) {
n46=    if ($2 != caps && $2 != emotes && $2 != symbol && $2 != spam && $2 != repeat && $2 != blacklist && $2 != links && $2 != silent && $2 != fakedonation ) { goto failure }
n47=    elseif ($3 != on && $3 != off && $3 != message && $3 != limitamount && $3 != limitpercentage && $3 != add && $3 != del && $3 != whitelist && $3 != timeout && $3 != regular && $3 != sub) { goto failure }
n48=    elseif (($2 == blacklist || $2 == links || $2 == fakedonation) && ( $3 == limitamount || $3 == limitpercentage)) { goto failure }
n49=    elseif (($2 != links) && ($3 == whitelist )) { goto failure }
n50=    elseif (($2 != emotes && $2 != blacklist && $2 != links) && ($3 == add || $3 == del)) { goto failure }
n51=    elseif (($3 == timeout) && ($4 !isnum || $4 == 0)) { goto failure }
n52=    elseif (($2 == repeat || $2 == emotes || $2 == spam ) && ($3 == limitpercentage)) { goto failure } 
n53=    elseif (($3 == regular) && ($4 != On && $4 != off)) { goto failure }
n54=    elseif (($3 == regular) && ($4 == On || $4 == off) && ( %protection. [ $+ [ # ] $+ ] . [ $+ [ $2 ] $+ ] .regular == $4)) { 
n55=      msg # Regulars are already protected in reference to $2 $+ .
n56=      break
n57=    }
n58=    elseif (($3 == sub) && ($4 != On && $4 != off)) { goto failure }
n59=    elseif (($3 == sub ) && ($4 == On || $4 == off) && ( %protection. [ $+ [ # ] $+ ] . [ $+ [ $2 ] $+ ] .sub == $4)) { 
n60=      msg # Subscribers are already protected in reference to $2 $+ .
n61=      break
n62=    }
n63=    elseif (( $2 != silent) && ($3 == On || $3 == Off )) && ( %protection. [ $+ [ # ] $+ ] . [ $+ [ $2 ] $+ ] .status == $3)) {
n64=      msg # /me $nick $+ , $2 protection is already $3 $+ .
n65=      break
n66=    }
n67=    elseif (($2 == Silent) && ($3 != on && $3 != off )) { goto failure }
n68=    elseif (($2 == Silent) && ($3 == On || $3 == Off )  && ( %protection. [ $+ [ # ] $+ ] .silent == $3 )) {
n69=      msg # /me $nick $+ , Silent mode is already $3 $+ .
n70=      break
n71=    }
n72=    elseif (($2 == Silent) && ($3 == On || $3 == Off )) {
n73=      set %protection. [ $+ [ # ] $+ ] .silent $3 
n74=      msg # /me $nick $+ , Silent mode is now $3 $+ .
n75=      break
n76=    }
n77=    else {
n78=      if ( $3 == On || $3 == Off ) {
n79=        set %protection. [ $+ [ # ] $+ ] . [ $+ [ $2 ] $+ ] .status $3
n80=        msg # $nick $+ , $2 protection has been turned $3 $+ .
n81=        break
n82=      }
n83=      elseif ($3 == add || $3 == del) {
n84=        var %file $2 $+ .ini
n85=        if ($3 == add) {
n86=          if ($ini(%file,#,$4) == $null) {
n87=            writeini %file # $4 1
n88=            if (emotes == $2) { msg # /me $4 will no longer be counted against the maximum emote limit. }
n89=            else { msg # /me $4 has been added to $2 $+ . }
n90=          }
n91=          else {
n92=            msg # /me $4 is already in $2 $+ . 
n93=          }
n94=        }
n95=        elseif ($3 == del) {
n96=          if ($ini(%file,#,$4) != $null) {
n97=            remini %file # $4
n98=            if (emotes == $2) { msg # /me $4 will be counted against the maximum emote limit. }
n99=            else { msg # /me $4 has been removed from $2 $+ . }
n100=          }
n101=          else {
n102=            msg # Sorry, $4 was not found in $2 $+ .
n103=          }
n104=        }
n105=      }
n106=      elseif ($3 == whitelist) && ($4 == add || $4 == del) {
n107=        var %file $3 $+ .ini
n108=        if ($4 == add) {
n109=          if ($ini(%file,#,$5) == $null) {
n110=            writeini %file # $5 1
n111=            msg # /me $5 has been added to $3 $+ .
n112=          }
n113=          else {
n114=            msg # /me $5 is already in $3 $+ .
n115=          }
n116=        }
n117=        elseif ($4 == del) {
n118=          if ($ini(%file,#,$5) != $null) {
n119=            remini %file # $5
n120=            msg # /me $5 has been removed from $3 $+ .
n121=          }
n122=        }
n123=      }
n124=      else {
n125=        set %protection. [ $+ [ # ] $+ ] . [ $+ [ $2 ] $+ ] . [ $+ [ $3 ] ] $4-
n126=        msg # $nick $+ , $3 has been set for $2 $+ . 
n127=        halt
n128=        :failure
n129=        msg # $nick For more info about how to set the protection settings, visit [link].
n130=        break
n131=      }
n132=    }
n133=  }
n134=}
n135=
n136=on *:text:!permit*:#: {
n137=  if ($msgtags(mod).key == 1 || $right(#,-1) == $nick) {
n138=    set -u30 %permit $addtok(%permit,$2,32)
n139=    msg $chan You have 30 seconds to post a link, $2
n140=  }
n141=}
n142=
n143=on *:TEXT:*:#: {
n144=  if ($msgtags(mod).key == 1) { return }
n145=  if ($nick == $right(#,-1)) { return }
n146=  var %pmessage $1-
n147=  var %emotecount 0
n148=  var %plines $numtok($1-,32)
n149=  if ($msgtags(emotes).key == $null) { goto continue }
n150=  while (%plines) {
n151=    if ($readini(allemotes.ini, emotes, $gettok(%pmessage,%plines,32)) != $null) {
n152=      set %pmessage $deltok(%pmessage,%plines,32)
n153=      var %emotecount $calc(%emotecount + 1)
n154=    }
n155=    dec %plines
n156=  } 
n157=  :continue
n158=  if (%protection. [ $+ [ # ] $+ ] .links.status == On ) {
n159=    if ((Regular. [ $+ [ # ] ] isin $level($nick)) && (%protection. [ $+ [ # ] $+ ] .links.regular == On )) { return }
n160=    if ($msgtags(subscriber).key == 1) && (%protection. [ $+ [ # ] $+ ] .links.sub == On ) { return }
n161=    if ($istok(%permit,$nick,32)) { return }
n162=    var %q = 1 | while $ini(links.ini, # ,%q) {
n163=      var %listl = %listl $v1
n164=      inc %q
n165=    }
n166=    var %g = 0
n167=    while (%g < $numtok(%listl,32)) {
n168=      inc %g
n169=      var %link = $gettok(%listl,%g,32)
n170=      if (%link isin $1-) {
n171=        var %w = 1 | while $ini(whitelist.ini,#,%w) {
n172=          var %listwl = %listwl $v1
n173=          inc %w
n174=        }
n175=        var %wl = 0
n176=        while (%wl < $numtok(%listwl,32)) {
n177=          inc %wl
n178=          var %wli = $gettok(%listwl,%wl,32)
n179=          if (%wli isin $1-) {
n180=            goto continuingprotection
n181=          }
n182=        }
n183=        var %fff = 1 | while $ini(pun.ini,pun,%fff) {
n184=          var %listp = %listp $v1
n185=          inc %fff
n186=        }
n187=        var %ggg = 0
n188=        while (%ggg < $numtok(%listp,32)) {
n189=          inc %ggg
n190=          var %ddd  $gettok(%listp,%ggg,32)
n191=          if (%link $+ %ddd isin $1-) { goto linktimeout }
n192=          elseif (%ddd $+ %link isin $1-) { goto stop } 
n193=        }  
n194=        elseif ($chr(32) $+ %link iswm $1-) { goto linktimeout }
n195=        if (* $+ %link $+ & iswm $1- ) {
n196=          :stop
n197=          goto continuingprotection
n198=        }
n199=        else {
n200=          :linktimeout
n201=          msg # .timeout $nick %protection. [ $+ [ # ] $+ ] .links.timeout No links please.
n202=          if (%protection. [ $+ [ # ] $+ ] .silent == Off) {
n203=            if ((%floodlinks) || ($($+(%,floodlinks.,$2),2))) { return } 
n204=            msg #  $nick $+ , %protection. [ $+ [ # ] $+ ] .links.message
n205=            set -u15 %floodlinks On
n206=          }
n207=          break
n208=        }
n209=      } 
n210=    }
n211=  }
n212=  :continuingprotection
n213=  if (%protection. [ $+ [ # ] $+ ] .emotes.status == On ) {
n214=    if ((Regular. [ $+ [ # ] ] isin $level($nick)) && (%protection. [ $+ [ # ] $+ ] .emotes.regular == On )) { return }
n215=    if ($msgtags(subscriber).key == 1) && (%protection. [ $+ [ # ] $+ ] .emotes.sub == On ) { return }
n216=    var %emotemessage = $1-
n217=    var %i = 1 | while $ini(emotes.ini,#,%i) {
n218=      var %list = %list $v1
n219=      inc %i
n220=    }
n221=    var %j = 0
n222=    while (%j < $numtok(%list,32)) {
n223=      inc %j 
n224=      var %words = $gettok(%list,%j,32)
n225=      var %p $countcs($strip($1-),%words)
n226=      var %emotecount $calc(%emotecount - %p)
n227=    }
n228=    if (%emotecount >= %protection. [ $+ [ # ] $+ ] .emotes.limitamount ) {
n229=      msg # /timeout $nick %protection. [ $+ [ # ] $+ ] .emotes.timeout Easy on the emotes please. 
n230=      if (%protection. [ $+ [ # ] $+ ] .silent == Off) {
n231=        if ((%floodemotes) || ($($+(%,floodemotes.,$2),2))) { return } 
n232=        msg $chan $nick $+ , %protection. [ $+ [ # ] $+ ] .emotes.message
n233=        set -u15 %floodemotes On
n234=      }      
n235=      break
n236=    }
n237=  }
n238=
n239=  if (%protection. [ $+ [ # ] $+ ] .caps.status == On ) {
n240=    if ((Regular. [ $+ [ # ] ] isin $level($nick)) && (%protection. [ $+ [ # ] $+ ] .caps.regular == On )) { return }
n241=    if ($msgtags(subscriber).key == 1) && (%protection. [ $+ [ # ] $+ ] .caps.sub == On ) { return }
n242=    if ( $len($1-) >= %protection. [ $+ [ # ] $+ ] .caps.limitamount ) {
n243=      if ( $calc($regex( [ $+ [ %pmessage ] $+ ],/[A-Z]/g) / $regex( [ $+ [ %pmessage ] $+ ],/[A-Z]/gi) * 100) >= %protection. [ $+ [ # ] $+ ] .caps.limitpercentage ) {
n244=        msg # /timeout $nick %protection. [ $+ [ # ] $+ ] .caps.timeout Easy on the caps please.
n245=        if (%protection. [ $+ [ # ] $+ ] .silent == Off) {
n246=          if ((%floodcaps) || ($($+(%,floodcaps.,$2),2))) { return } 
n247=          msg # $nick $+ , %protection. [ $+ [ # ] $+ ] .caps.message
n248=          set -u15 %floodcaps On
n249=        }
n250=        halt
n251=      }
n252=    }
n253=  }
n254=
n255=  if (%protection. [ $+ [ # ] $+ ] .symbol.status == On ) {
n256=    if ((Regular. [ $+ [ # ] ] isin $level($nick)) && (%protection. [ $+ [ # ] $+ ] .sybmbol.regular == On )) { return }
n257=    if ($msgtags(subscriber).key == 1) && (%protection. [ $+ [ # ] $+ ] .symbol.sub == On ) { return }
n258=    if ( $len($1-) >= %protection. [ $+ [ # ] $+ ] .symbol.limitamount ) {
n259=      if ( $calc( $regex([ $+ [ %pmessage ] $+ ],/[^a-z0-9]/gi) * 100 / $len(%pmessage) ) >= %protection. [ $+ [ # ] $+ ] .symbol.limitpercentage ) {
n260=        msg $chan .timeout $nick %protection. [ $+ [ # ] $+ ] .symbol.timeout Easy on the symbols please.
n261=        if (%protection. [ $+ [ # ] $+ ] .silent == Off) {
n262=          if ((%floodsymbols) || ($($+(%,floodsymbols.,$2),2))) { return } 
n263=          msg #  $nick $+ , %protection. [ $+ [ # ] $+ ] .symbol.message
n264=          set -u15 %floodsymbols On
n265=        }
n266=        halt
n267=      }
n268=    }
n269=  } 
n270=  if (%protection. [ $+ [ # ] $+ ] .repeat.status == On ) {
n271=    if ((Regular. [ $+ [ # ] ] isin $level($nick)) && (%protection. [ $+ [ # ] $+ ] .repeat.regular == On )) { return }
n272=    if ($msgtags(subscriber).key == 1) && (%protection. [ $+ [ # ] $+ ] .repeat.sub == On ) { return }
n273=    if ($1- == $readini(RepeatedMessages.ini,#, $nick)) {
n274=      var %times $calc($readini(RepeatedMessagesTimes.ini, #, $nick) + 1)
n275=      if (%times >= %protection. [ $+ [ # ] $+ ] .repeat.limitamount) {
n276=        msg # /timeout $nick %protection. [ $+ [ # ] $+ ] .repeat.timeout Please stop repeating.
n277=        if (%protection. [ $+ [ # ] $+ ] .silent == Off) {
n278=          if ((%floodrepeat) || ($($+(%,floodrepeat.,$2),2))) { return } 
n279=          msg #  $nick $+ , %protection. [ $+ [ # ] $+ ] .repeat.message
n280=          set -u15 %floodrepeat On
n281=        }
n282=        writeini RepeatedMessagesTimes.ini # $nick %times
n283=        halt
n284=      }
n285=      else {
n286=        writeini RepeatedMessagesTimes.ini # $nick %times
n287=      }
n288=    }
n289=    else {
n290=      writeini RepeatedMessagesTimes.ini # $nick 1
n291=      writeini RepeatedMessages.ini # $nick $1-
n292=    }
n293=  }
n294=  if (%protection. [ $+ [ # ] $+ ] .spam.status == On ) {
n295=    if ((Regular. [ $+ [ # ] ] isin $level($nick)) && (%protection. [ $+ [ # ] $+ ] .spam.regular == On )) { return }
n296=    if ($msgtags(subscriber).key == 1) && (%protection. [ $+ [ # ] $+ ] .spam.sub == On ) { return }
n297=    var %spam = 1
n298=    while ($gettok($1-, %spam, 32) != $null) {
n299=      var %word = $v1
n300=      var %protectionspam. %protection. [ $+ [ # ] $+ ] .spam.limitamount
n301=      set %protectionspam %protectionspam.
n302=      if ($sticky(%word) != $null) {
n303=        msg $chan .timeout $nick %protection. [ $+ [ # ] $+ ] .spam.timeout Please stop spamming.
n304=        if (%floodspam || ($($+(%,floodspam.,$2),2))) { return } 
n305=        if (%protection. [ $+ [ # ] $+ ] .silent == Off) {
n306=          msg #  $nick $+ , %protection. [ $+ [ # ] $+ ] .spam.message
n307=          set -u15 %floodspam On
n308=        }
n309=        break
n310=      }
n311=      inc %spam
n312=    }
n313=  }
n314=  if (%protection. [ $+ [ # ] $+ ] .blacklist.status == On ) {
n315=    if ((Regular. [ $+ [ # ] ] isin $level($nick)) && (%protection. [ $+ [ # ] $+ ] .blacklist.regular == On )) { return }
n316=    if ($msgtags(subscriber).key == 1) && (%protection. [ $+ [ # ] $+ ] .blacklist.sub == On ) { return }
n317=    if ($chr(42) $+ $chr(42) $+ $chr(42) == $1-) { goto timeout }
n318=    if ($chr(32) $+ $chr(42) $+ $chr(42) $+ $chr(42) $+ $chr(32) isin $1- ) { goto timeout }
n319=    var %blackcount = 1 | while $ini(blacklist.ini,#,%blacklist) {
n320=      var %blacklistlist = %blacklistlistlist $v1
n321=      inc %blackcount
n322=    }
n323=    var %black = 0
n324=    while (%black < $numtok(%blacklistlist,32)) {
n325=      inc %black
n326=      var %words = $gettok(%blacklistlist,%black,32)
n327=      var %blackamount = $countcs($strip($1-),%words)     
n328=      if (%blackamount >= 1) {
n329=        :timeout
n330=        msg # /timeout $nick %protection. [ $+ [ # ] $+ ] .blacklist.timeout Please keep it PG. 
n331=        if ((%floodblacklist) || ($($+(%,floodblacklist.,$2),2))) { return } 
n332=        if (%protection. [ $+ [ # ] $+ ] .silent == Off)  {
n333=          msg $chan  $nick $+ , %protection. [ $+ [ # ] $+ ] .blacklist.message
n334=          set -u15 %floodblacklist On
n335=        }      
n336=        break
n337=      }
n338=    }
n339=  }
n340=}
n341=
n342=on *:action:*:#:{
n343=  if ($msgtags(mod).key == 1) { return }
n344=  if (Regular. [ $+ [ # ] ] isin $level($nick)) && (%protection. [ $+ [ # ] $+ ] .fakedonation.regular == On )) { return }
n345=  if ($msgtags(subscriber).key == 1) && (%protection. [ $+ [ # ] $+ ] .fakedonation.sub == On ) { return }
n346=  if (%protection. [ $+ [ # ] $+ ] .fakedonation.status == Off ) { return }
n347=  if ( $ isin $1- || donate isin $1-) {
n348=    if (%protection. [ $+ [ # ] $+ ] .silent == Off) {
n349=      msg $chan  $nick $+ , %protection. [ $+ [ # ] $+ ] .fakedonation.message
n350=    }
n351=    msg # /timeout $nick %protection. [ $+ [ # ] $+ ] .fakedonation.timeout No fake donations here
n352=  }
n353=}
